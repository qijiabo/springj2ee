<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hisign.jsrd.dao.JsrdInfoMapper">
	<resultMap id="JsrdCaseResultMap" type="com.hisign.model.CaseBaseInfo" >
    <id column="ID" property="id" jdbcType="VARCHAR" />
    <result column="SOURCE" property="source" jdbcType="VARCHAR" />
    <result column="RECEPTION_NO" property="receptionNo" jdbcType="VARCHAR" />
    <result column="CASE_NO" property="caseNo" jdbcType="VARCHAR" />
    <result column="INVESTIGATION_NO" property="investigationNo" jdbcType="VARCHAR" />
    <result column="REPER_DATE" property="reperDate" jdbcType="DATE" typeHandler="com.hisign.DateToStringTypeHandler" />
    <result column="CASE_NAME" property="caseName" jdbcType="VARCHAR" />
    <result column="CASE_KIND" property="caseKind" jdbcType="VARCHAR" />
    <result column="CASE_KIND_CN" property="caseKindCn" jdbcType="VARCHAR" />
    <result column="CASE_STATE" property="caseState" jdbcType="VARCHAR" />
    <result column="CASE_STATE_CN" property="caseStateCn" jdbcType="VARCHAR" />
    <result column="CASE_DESC" property="caseDesc" jdbcType="VARCHAR" />
    <result column="OCCURR_GOVER" property="occurrGover" jdbcType="VARCHAR" />
    <result column="OCCURR_GOVER_CN" property="occurrGoverCn" jdbcType="VARCHAR" />
    <result column="OCCURR_AREA" property="occurrArea" jdbcType="VARCHAR" />
    <result column="OCCURR_AREA_CN" property="occurrAreaCn" jdbcType="VARCHAR" />
    <result column="OCCURR_PLACE" property="occurrPlace" jdbcType="VARCHAR" />
    <result column="OCCURR_DATE_FROM" property="occurrDateFrom" jdbcType="DATE" typeHandler="com.hisign.DateToDayStringTypeHandler" />
    <result column="OCCURR_DATE_TO" property="occurrDateTo" jdbcType="DATE" typeHandler="com.hisign.DateToStringTypeHandler" />
    <result column="INVEST_DATE_FROM" property="investDateFrom" jdbcType="DATE" typeHandler="com.hisign.DateToStringTypeHandler" />
    <result column="INVEST_DATE_TO" property="investDateTo" jdbcType="DATE" typeHandler="com.hisign.DateToStringTypeHandler" />
    <result column="INVEST_PLACE" property="investPlace" jdbcType="VARCHAR" />
    <result column="INVEST_UNIT" property="investUnit" jdbcType="VARCHAR" />
    <result column="INVEST_UNIT_CN" property="investUnitCn" jdbcType="VARCHAR" />
    <result column="DIRECTOR" property="director" jdbcType="VARCHAR" />
    <result column="INVESTIGATOR" property="investigator" jdbcType="VARCHAR" />
    <result column="DIRECTOR_IDS" property="directorIds" jdbcType="VARCHAR" />
    <result column="INVESTIGATOR_IDS" property="investigatorIds" jdbcType="VARCHAR" />
    <result column="INVESTIGATOR_DUTIES" property="investigatorDuties" jdbcType="VARCHAR" />
    <result column="ACCEPT_DATE" property="acceptDate" jdbcType="DATE" typeHandler="com.hisign.DateToStringTypeHandler" />
    <result column="ACCEPT_UNIT" property="acceptUnit" jdbcType="VARCHAR" />
    <result column="ACCEPT_UNIT_CN" property="acceptUnitCn" jdbcType="VARCHAR" />
    <result column="REG_DATE" property="regDate" jdbcType="VARCHAR" />
    <result column="ADDS_REG_REASON" property="addsRegReason" jdbcType="VARCHAR" />
    <result column="ADDS_REG_REASON_CN" property="addsRegReasonCn" jdbcType="VARCHAR" />
    <result column="REG_UNIT" property="regUnit" jdbcType="VARCHAR" />
    <result column="REG_UNIT_CN" property="regUnitCn" jdbcType="VARCHAR" />
    <result column="MANAGE_UNIT" property="manageUnit" jdbcType="VARCHAR" />
    <result column="MANAGE_UNIT_CN" property="manageUnitCn" jdbcType="VARCHAR" />
    <result column="MANAGE_PERSON" property="managePerson" jdbcType="VARCHAR" />
    <result column="MANAGE_PERSON_TEL" property="managePersonTel" jdbcType="VARCHAR" />
    <result column="REG_FLAG" property="regFlag" jdbcType="CHAR" />
    <result column="SOLVE_FLAG" property="solveFlag" jdbcType="CHAR" />
    <result column="CLOSE_FLAG" property="closeFlag" jdbcType="CHAR" />
    <result column="CANCELLE_FLAG" property="cancelleFlag" jdbcType="CHAR" />
    <result column="BUNCH_FLAG" property="bunchFlag" jdbcType="CHAR" />
    <result column="IDENTIFY_FLAG" property="identifyFlag" jdbcType="CHAR" />
    <result column="LINK_STATE" property="linkState" jdbcType="CHAR" />
    <result column="LONGITUDE" property="longitude" jdbcType="VARCHAR" />
    <result column="LATITUDE" property="latitude" jdbcType="VARCHAR" />
    <result column="DELETE_FLAG" property="deleteFlag" jdbcType="CHAR" />
    <result column="TRANSFER_TIME" property="transferTime" jdbcType="DATE" typeHandler="com.hisign.DateToStringTypeHandler" />
    <result column="CREATE_UNIT" property="createUnit" jdbcType="VARCHAR" />
    <result column="CREATE_UNIT_CN" property="createUnitCn" jdbcType="VARCHAR" />
    <result column="CREATE_DATE" property="createDate" jdbcType="DATE" typeHandler="com.hisign.DateToStringTypeHandler" />
    <result column="CREATE_USER_ID" property="createUserId" jdbcType="VARCHAR" />
    <result column="CREATE_USER_NAME" property="createUserName" jdbcType="VARCHAR" />
    <result column="MODIFY_DATE" property="modifyDate" jdbcType="DATE" typeHandler="com.hisign.DateToStringTypeHandler" />
    <result column="MODIFY_USER_ID" property="modifyUserId" jdbcType="VARCHAR" />
    <result column="MODIFY_USER_NAME" property="modifyUserName" jdbcType="VARCHAR" />
    <result column="REV1" property="rev1" jdbcType="VARCHAR" />
    <result column="REV2" property="rev2" jdbcType="VARCHAR" />
    <result column="REV3" property="rev3" jdbcType="VARCHAR" />
    <result column="REV4" property="rev4" jdbcType="VARCHAR" />
    <result column="REV5" property="rev5" jdbcType="VARCHAR" />
    <result column="REV6" property="rev6" jdbcType="VARCHAR" />
    <result column="REV7" property="rev7" jdbcType="VARCHAR" />
    <result column="REV8" property="rev8" jdbcType="VARCHAR" />
    <result column="CASE_PROPERTY" property="caseProperty" jdbcType="VARCHAR" />
    <result column="CASE_PROPERTY_CN" property="casePropertyCn" jdbcType="VARCHAR" />
    <result column="COMMISSION_MEANS_POINTS" property="commissionMeansPoints" jdbcType="VARCHAR" />
    <result column="identifyFlag" property="identifyFlag" jdbcType="VARCHAR" />
    
    <result column="DNA_FLAG" property="hjwz.dnaFlag" jdbcType="VARCHAR" />
    <result column="DNA_NO" property="hjwz.dnaNo" jdbcType="VARCHAR" />
    <result column="DNA_AMOUNT" property="hjwz.dnaAmount" jdbcType="VARCHAR" />
    <result column="FOOTPRINT_FLAG" property="hjwz.footprintFlag" jdbcType="VARCHAR" />
    <result column="FOOTPRINT_NO" property="hjwz.footprintNo" jdbcType="VARCHAR" />
    <result column="FOOTPRINT_AMOUNT" property="hjwz.footprintAmount" jdbcType="VARCHAR" />
    <result column="HANDPRINT_FLAG" property="hjwz.handprintFlag" jdbcType="VARCHAR" />
    <result column="HANDPRINT_NO" property="hjwz.handprintNo" jdbcType="VARCHAR" />
    <result column="HANDPRINT_AMOUNT" property="hjwz.handprintAmount" jdbcType="VARCHAR" />
    <result column="VIDEO_EVIDENCE_FLAG" property="hjwz.videoEvidenceFlag" jdbcType="VARCHAR" />
    <result column="VIDEO_EVIDENCE_NO" property="hjwz.videoEvidenceNo" jdbcType="VARCHAR" />
    <result column="VIDEO_EVIDENCE_AMOUNT" property="hjwz.videoEvidenceAmount" jdbcType="VARCHAR" />
  </resultMap>
  
  
<resultMap id="JsrdAllInfoResultMap" type="com.hisign.jsrd.model.IdentifyInfo" >
    <id column="ID" property="id" jdbcType="VARCHAR" />
    <result column="PER_ID" property="perId" jdbcType="VARCHAR" />
    <result column="CASE_ID" property="caseId" jdbcType="VARCHAR" />
    <result column="IDENTIFY_RANGE" property="identifyRange" jdbcType="VARCHAR" />
    <result column="IDENTIFY_WAY" property="identifyWay" jdbcType="VARCHAR" />
    <result column="IDENTIFY_SOURCE" property="identifySource" jdbcType="VARCHAR" />
    <result column="PERSON_SOURCE" property="personSource" jdbcType="VARCHAR" />
	<result column="IDENTIFY_BY" property="identifyBy" jdbcType="VARCHAR" />
	<result column="IDENTIFY_UNIT" property="identifyUnit" jdbcType="VARCHAR" />
	<result column="IDENTIFY_UNIT_CN" property="identifyUnitCn" jdbcType="VARCHAR" />
	<result column="IDENTIFY_DATE" property="identifyDate" jdbcType="DATE" typeHandler="com.hisign.DateToStringTypeHandler" />
	<result column="IDENTIFY_NO" property="identifyNo" jdbcType="VARCHAR" />
	<result column="TRANS_NO" property="transNo" jdbcType="VARCHAR" />
	<result column="PERSONNEL_NO" property="personnelNo" jdbcType="VARCHAR" />
	<result column="FOOT_NO" property="footNo" jdbcType="VARCHAR" />
	<result column="REMARK" property="remark" jdbcType="VARCHAR" />
	<result column="DELETE_FLAG" property="deleteFlag" jdbcType="CHAR" />
    <result column="TRANSFER_TIME" property="transferTime" jdbcType="DATE" typeHandler="com.hisign.DateToStringTypeHandler" />
    <result column="CREATE_UNIT" property="createUnit" jdbcType="VARCHAR" />
    <result column="CREATE_UNIT_CN" property="createUnitCn" jdbcType="VARCHAR" />
    <result column="CREATE_DATE" property="createDate" jdbcType="DATE" typeHandler="com.hisign.DateToStringTypeHandler" />
    <result column="CREATE_USER_ID" property="createUserId" jdbcType="VARCHAR" />
    <result column="CREATE_USER_NAME" property="createUserName" jdbcType="VARCHAR" />
    <result column="MODIFY_DATE" property="modifyDate" jdbcType="DATE" typeHandler="com.hisign.DateToStringTypeHandler" />
    <result column="MODIFY_USER_ID" property="modifyUserId" jdbcType="VARCHAR" />
    <result column="MODIFY_USER_NAME" property="modifyUserName" jdbcType="VARCHAR" />
    
    <result column="INVESTIGATION_NO" property="caseInfo.investigationNo" jdbcType="VARCHAR" />
    <result column="CASE_NO" property="caseInfo.caseNo" jdbcType="VARCHAR" />
    <result column="case_kind" property="caseInfo.caseKind" jdbcType="VARCHAR" />
    <result column="occurr_date_from" property="caseInfo.occurrDateFrom" jdbcType="DATE" typeHandler="com.hisign.DateToStringTypeHandler" />
    <result column="occurr_place" property="caseInfo.occurrPlace" jdbcType="VARCHAR" />
    <result column="bunchFlag" property="caseInfo.bunchFlag" jdbcType="VARCHAR" />
    
    <result column="NAME" property="person.name" jdbcType="VARCHAR" />
    <result column="BIRTH_DATE" property="person.birthDate" jdbcType="DATE" typeHandler="com.hisign.DateToStringTypeHandler" />
	<result column="ID_CARD_NO" property="person.idCardNo" jdbcType="VARCHAR" />
	<result column="NATIVE_ADDRESS" property="person.nativeAddress" jdbcType="VARCHAR" />
	<result column="CAPTURE_FLAG" property="person.captureFlag" jdbcType="VARCHAR" />
	<result column="CONTROL_FLAG" property="person.controlFlag" jdbcType="VARCHAR" />
  </resultMap>
  
  
  <resultMap id="JsrdPersonResultMap" type="com.hisign.model.TPBaseInfoModel" >
     <id column="ID" property="id" jdbcType="VARCHAR" />
    <result column="SOURCE" property="source" jdbcType="VARCHAR" />
    <result column="PER_NO" property="perNo" jdbcType="VARCHAR" />
    <result column="NAME" property="name" jdbcType="VARCHAR" />
    <result column="SPELL" property="spell" jdbcType="VARCHAR" />
    <result column="ALIAS" property="alias" jdbcType="VARCHAR" />
    <result column="GENDER" property="gender" jdbcType="VARCHAR" />
    <result column="GENDER_CN" property="genderCn" jdbcType="VARCHAR" />
    <result column="BIRTH_DATE" property="birthDate" jdbcType="DATE" typeHandler="com.hisign.DateToStringTypeHandler" />
    <result column="ID_CARD_NO" property="idCardNo" jdbcType="VARCHAR" />
    <result column="NATIONALITY" property="nationality" jdbcType="VARCHAR" />
    <result column="NATIONALITY_CN" property="nationalityCn" jdbcType="VARCHAR" />
    <result column="NATION" property="nation" jdbcType="VARCHAR" />
    <result column="NATION_CN" property="nationCn" jdbcType="VARCHAR" />
    <result column="NATIVE_AREA" property="nativeArea" jdbcType="VARCHAR" />
    <result column="NATIVE_AREA_CN" property="nativeAreaCn" jdbcType="VARCHAR" />
    <result column="NATIVE_ADDRESS" property="nativeAddress" jdbcType="VARCHAR" />
    <result column="CURRENT_AREA" property="currentArea" jdbcType="VARCHAR" />
    <result column="CURRENT_AREA_CN" property="currentAreaCn" jdbcType="VARCHAR" />
    <result column="CURRENT_ADDRESS" property="currentAddress" jdbcType="VARCHAR" />
    <result column="STATE" property="state" jdbcType="VARCHAR" />
    <result column="STATE_CN" property="stateCn" jdbcType="VARCHAR" />
    <result column="DELETE_FLAG" property="deleteFlag" jdbcType="CHAR" />
    <result column="TRANSFER_TIME" property="transferTime" jdbcType="DATE" typeHandler="com.hisign.DateToStringTypeHandler" />
    <result column="CREATE_UNIT" property="createUnit" jdbcType="VARCHAR" />
    <result column="CREATE_UNIT_CN" property="createUnitCn" jdbcType="VARCHAR" />
    <result column="CREATE_DATE" property="createDate" jdbcType="DATE" typeHandler="com.hisign.DateToStringTypeHandler" />
    <result column="CREATE_USER_ID" property="createUserId" jdbcType="VARCHAR" />
    <result column="CREATE_USER_NAME" property="createUserName" jdbcType="VARCHAR" />
    <result column="MODIFY_DATE" property="modifyDate" jdbcType="DATE" typeHandler="com.hisign.DateToStringTypeHandler" />
    <result column="MODIFY_USER_ID" property="modifyUserId" jdbcType="VARCHAR" />
    <result column="MODIFY_USER_NAME" property="modifyUserName" jdbcType="VARCHAR" />
    <result column="REV1" property="rev1" jdbcType="VARCHAR" />
    <result column="REV2" property="rev2" jdbcType="VARCHAR" />
    <result column="REV3" property="rev3" jdbcType="VARCHAR" />
    <result column="REV4" property="rev4" jdbcType="VARCHAR" />
    <result column="REV5" property="rev5" jdbcType="VARCHAR" />
    <result column="REV6" property="rev6" jdbcType="VARCHAR" />
    <result column="REV7" property="rev7" jdbcType="VARCHAR" />
    <result column="REV8" property="rev8" jdbcType="VARCHAR" />
   
  </resultMap>
  
   <sql id="order_By_String" >  
	<if test="orderByString != null and orderByString != ''">
		${orderByString}
	</if>    
  </sql>
  <sql id="OraclePagePrefix_head1" >  
      select all_.*
  </sql>
  <sql id="OraclePagePrefix_head2" >  
      from ( select row_.*, rownum rownum_ from (   
  </sql>  
  <sql id="OraclePageSuffix" >
     <![CDATA[ ) row_ where rownum <= #{endNum} ) all_ where rownum_ > #{startNum} ]]>  
  </sql>
  
  
    <sql id="caseBaseInfo_col" >
	b.ID, SOURCE, RECEPTION_NO, CASE_NO, INVESTIGATION_NO, REPER_DATE,
	CASE_NAME, CASE_KIND,
	CASE_KIND_CN, CASE_STATE, CASE_STATE_CN, CASE_DESC, OCCURR_GOVER, OCCURR_GOVER_CN,
	OCCURR_AREA, OCCURR_AREA_CN, OCCURR_PLACE, OCCURR_DATE_FROM,
	OCCURR_DATE_TO, INVEST_DATE_FROM,
	INVEST_DATE_TO, INVEST_PLACE, INVEST_UNIT, INVEST_UNIT_CN, DIRECTOR, INVESTIGATOR,
	DIRECTOR_IDS, INVESTIGATOR_IDS, INVESTIGATOR_DUTIES, ACCEPT_DATE,
	ACCEPT_UNIT, ACCEPT_UNIT_CN,
	REG_DATE, ADDS_REG_REASON, ADDS_REG_REASON_CN, REG_UNIT, REG_UNIT_CN,
	MANAGE_UNIT,
	MANAGE_UNIT_CN, MANAGE_PERSON, MANAGE_PERSON_TEL, REG_FLAG, SOLVE_FLAG, CLOSE_FLAG,
	CANCELLE_FLAG, BUNCH_FLAG, b.IDENTIFY_FLAG, LINK_STATE, LONGITUDE,
	LATITUDE, b.DELETE_FLAG,
	b.TRANSFER_TIME, b.CREATE_UNIT, b.CREATE_UNIT_CN, b.CREATE_DATE, b.CREATE_USER_ID,
	b.CREATE_USER_NAME,
	b.MODIFY_DATE, b.MODIFY_USER_ID, b.MODIFY_USER_NAME, b.REV1, b.REV2, b.REV3, b.REV4,
	b.REV5, b.REV6,b.REV7, b.REV8,
	e.HANDPRINT_FLAG,
	e.HANDPRINT_DESC,
	e.HANDPRINT_NO,
	e.PALMPRINT_FLAG,
	e.PALMPRINT_DESC,
	e.PALMPRINT_NO,
	e.DNA_FLAG,
	e.DNA_DESC,
	e.DNA_NO,
	e.FOOTPRINT_FLAG,
	e.FOOTPRINT_DESC,
	e.FOOTPRINT_NO,
	e.TOOLMARK_FLAG,
	e.TOOLMARK_DESC,
	e.TOOLMARK_NO ,
	e.VIDEO_EVIDENCE_FLAG ,
	e.VIDEO_EVIDENCE_DESC ,
	e.VIDEO_EVIDENCE_NO ,
	e.HANDPRINT_AMOUNT,
	e.PALMPRINT_AMOUNT,
	e.DNA_AMOUNT ,
	e.FOOTPRINT_AMOUNT ,
	e.VIDEO_EVIDENCE_AMOUNT
   </sql>
   
   
   <sql id="findJsrdCaseList_where" >
    <where >
    	<if test="occurrDateFrom != null and occurrDateFrom != ''" >
		   <![CDATA[ and b.OCCURR_DATE_FROM >= to_date(#{occurrDateFrom},'yyyy-mm-dd') ]]>
		</if>
    	<if test="occurrDateTo != null and occurrDateTo != ''" >
		   <![CDATA[ and b.OCCURR_DATE_TO < to_date(#{occurrDateTo},'yyyy-mm-dd') ]]>
		</if>
    	<if test="investDateFrom != null and investDateFrom != ''" >
		   <![CDATA[ and b.INVEST_DATE_FROM >= to_date(#{investDateFrom},'yyyy-mm-dd') ]]>
		</if>
    	<if test="investDateTo != null and investDateTo != ''" >
		   <![CDATA[ and b.INVEST_DATE_TO < to_date(#{investDateTo},'yyyy-mm-dd') ]]>
		</if>
    	<if test="director != null and director != ''" >
		  and b.DIRECTOR = #{director,jdbcType=VARCHAR}
		</if>
		<if test="investigator != null and investigator != ''" >
		  and b.INVESTIGATOR = #{investigator,jdbcType=VARCHAR}
		</if>
		<if test="investUnit != null and investUnit != ''" >
		  and b.INVEST_UNIT like #{investUnit,jdbcType=VARCHAR} || '%'
		</if>
		<if test="caseNo != null and caseNo != ''" >
		  and b.CASE_NO like #{caseNo,jdbcType=VARCHAR} || '%'
		</if>
		<if test="investigationNo != null and investigationNo != ''" >
		  and b.INVESTIGATION_NO like #{investigationNo,jdbcType=VARCHAR} || '%'
		</if>
  	</where>  
  </sql>
  
  
  <sql id="findJsrdPersonList_where" >
    <where >
    	<if test="sfzh != null and sfzh != ''" >
		   <![CDATA[ and p.id_card_no like #{sfzh,jdbcType=VARCHAR}||'%' ]]>
		</if>
		<if test="name != null and name != ''" >
		   <![CDATA[ and p.name like '%'||#{name,jdbcType=VARCHAR}||'%' ]]>
		</if>
		<if test="rybh != null and rybh != ''" >
		   <![CDATA[ and p.per_no like #{rybh,jdbcType=VARCHAR}||'%' ]]>
		</if>
  	</where>  
  </sql>
  
   <sql id="jsrdManagerList_where" >
    <where >
    	<if test="sfzh != null and sfzh != ''" >
		   <![CDATA[ and p.id_card_no like '%'||#{sfzh,jdbcType=VARCHAR}||'%' ]]>
		</if>
		<if test="name != null and name != ''" >
		   <![CDATA[ and p.name like '%'||#{name,jdbcType=VARCHAR}||'%' ]]>
		</if>
		<if test="rybh != null and rybh != ''" >
		   <![CDATA[ and p.per_no like #{rybh,jdbcType=VARCHAR}||'%' ]]>
		</if>
		<if test="caseNo != null and caseNo != ''" >
		   <![CDATA[ and b.case_no like #{caseNo,jdbcType=VARCHAR}||'%' ]]>
		</if>
		<if test="investigationNo != null and investigationNo != ''" >
		   <![CDATA[ and b.investigation_No like #{investigationNo,jdbcType=VARCHAR}||'%' ]]>
		</if>
		<if test="occurrDateFrom != null and occurrDateFrom != ''" >
		   <![CDATA[ and b.OCCURR_DATE_FROM >= to_date(#{occurrDateFrom},'yyyy-mm-dd') ]]>
		</if>
    	<if test="occurrDateTo != null and occurrDateTo != ''" >
		   <![CDATA[ and b.OCCURR_DATE_FROM < to_date(#{occurrDateTo},'yyyy-mm-dd') ]]>
		</if>
    	<if test="investDateFrom != null and investDateFrom != ''" >
		   <![CDATA[ and b.INVEST_DATE_FROM >= to_date(#{investDateFrom},'yyyy-mm-dd') ]]>
		</if>
    	<if test="investDateTo != null and investDateTo != ''" >
		   <![CDATA[ and b.INVEST_DATE_FROM < to_date(#{investDateTo},'yyyy-mm-dd') ]]>
		</if>
		<if test="rdsjStr != null and rdsjStr != ''" >
		   <![CDATA[ and t.identify_date >= to_date(#{rdsjStr},'yyyy-mm-dd') ]]>
		</if>
    	<if test="rdsjEnd != null and rdsjEnd != ''" >
		   <![CDATA[ and t.identify_date < to_date(#{rdsjEnd},'yyyy-mm-dd') ]]>
		</if>
		<if test="rddw != null and rddw != ''" >
		   <![CDATA[ and t.identify_unit like #{rddw,jdbcType=VARCHAR} || '%' ]]>
		</if>
		<if test="investUnit != null and investUnit != ''" >
		   and b.INVEST_UNIT like #{investUnit,jdbcType=VARCHAR} || '%'
		</if>
		
		and t.delete_flag='0'
  	</where>  
  </sql>
   
	
	<select id="findJsrdCaseList" parameterType="com.hisign.jsrd.model.JsrdFilter"
		resultMap="JsrdCaseResultMap">
		<include refid="OraclePagePrefix_head1" />
		
  		<include refid="OraclePagePrefix_head2" />
		select
			<include refid="caseBaseInfo_col" />
			,(select count(1) from T_C_IDENTIFY rd where rd.case_id=b.id and rd.delete_flag='0' and rownum=1)
		  as identifyFlag
		from t_c_baseinfo  b left join t_c_evidence e 
      	on b.id=e.case_id
			<include refid="findJsrdCaseList_where" />
		<include refid="order_By_String" />
    	<include refid="OraclePageSuffix" />
	</select>
	
	
	<select id="findJsrdCaseListForCount" parameterType="com.hisign.jsrd.model.JsrdFilter"
		resultType="java.lang.Integer">
		select
			count(1)
		from t_c_baseinfo b
		<include refid="findJsrdCaseList_where" />
	</select>
	
	<select id="getCaseInfoById" parameterType="java.lang.String"
		resultMap="JsrdCaseResultMap">
		select
			<include refid="caseBaseInfo_col" />
		from t_c_baseinfo b left join t_c_evidence e 
      	on b.id=e.case_id
		where b.id= #{id,jdbcType=VARCHAR}
	</select>
	
	
	 <insert id="insertJsrdInfoByIdentifyInfo" parameterType="com.hisign.jsrd.model.IdentifyInfo" >
	    <selectKey resultType="java.lang.String" keyProperty="id" order="BEFORE" >
	      select sys_guid() from dual
	    </selectKey>
	    insert into t_c_identify (
			ID  ,
			PER_ID  ,
			CASE_ID  ,
			INVESTIGATION_NO,
			IDENTIFY_WAY ,
			IDENTIFY_SOURCE ,
			IDENTIFY_BY,
			IDENTIFY_UNIT,
			IDENTIFY_UNIT_CN ,
			IDENTIFY_DATE  ,
			IDENTIFY_NO  ,
			TRANS_NO ,
			PERSONNEL_NO  ,
			DELETE_FLAG  ,
			TRANSFER_TIME  ,
			CREATE_UNIT  ,
			CREATE_UNIT_CN ,
			CREATE_DATE	,
			CREATE_USER_ID	,
			CREATE_USER_NAME	,
			MODIFY_DATE	,
			MODIFY_USER_ID	,
			MODIFY_USER_NAME	
		)values(
			#{id,jdbcType=VARCHAR}, 
			#{person.id,jdbcType=VARCHAR}, 
			#{caseId,jdbcType=VARCHAR}, 
			#{investigationNo,jdbcType=VARCHAR}, 
			#{identifyWay,jdbcType=VARCHAR}, 
			#{identifySource,jdbcType=VARCHAR}, 
			#{identifyBy,jdbcType=VARCHAR},
			#{identifyUnit,jdbcType=VARCHAR},
			#{identifyUnitCn,jdbcType=VARCHAR},
			#{identifyDate,jdbcType=DATE,typeHandler=com.hisign.DateToStringTypeHandler},
			#{identifyNo,jdbcType=VARCHAR},
			#{transNo,jdbcType=VARCHAR},
			#{personnelNo,jdbcType=VARCHAR},
			'0',
			sysdate,
			#{createUnit,jdbcType=VARCHAR},
			#{createUnitCn,jdbcType=VARCHAR},
			sysdate,
			#{createUserId,jdbcType=VARCHAR},
			#{createUserName,jdbcType=VARCHAR},
			sysdate,
			#{createUserId,jdbcType=VARCHAR},
			#{createUserName,jdbcType=VARCHAR}
		)
  </insert>
  
  
  
  	<select id="findJsrdPersonList" parameterType="com.hisign.jsrd.model.JsrdFilter"
		resultMap="JsrdPersonResultMap">
		<include refid="OraclePagePrefix_head1" />
  		<include refid="OraclePagePrefix_head2" />
		select
			p.id as id,
			p.PER_NO as perNo,
			p.NAME as name,
			to_char(p.BIRTH_DATE,'yyyy-MM-dd') as birthDate,
			p.id_card_no as idCardNo,
			p.NATIVE_ADDRESS as nativeAddress,
			p.capture_flag as captureFlag,
			p.control_flag as controlFlag,
			(select c.capture_date
		          from t_p_capture c
		         where c.per_id = p.id
		           and c.delete_flag = '0'
		           and rownum = 1) as captureDate,
		       (select c.capture_unit
		          from t_p_capture c
		         where c.per_id = p.id
		           and c.delete_flag = '0'
		           and rownum = 1) as captureUnit
		from t_p_baseinfo p
		<include refid="findJsrdPersonList_where" />
		<include refid="order_By_String" />
    	<include refid="OraclePageSuffix" />
	</select>
	
	<select id="findJsrdPersonListForCount" parameterType="com.hisign.jsrd.model.JsrdFilter"
		resultType="java.lang.Integer">
		select
			count(1)
		from t_p_baseinfo p
		<include refid="findJsrdPersonList_where" />
	</select>
	
	<select id="findJsrdManagerList" parameterType="com.hisign.jsrd.model.JsrdFilter"
		resultMap="JsrdAllInfoResultMap">
		<include refid="OraclePagePrefix_head1" />
  		<include refid="OraclePagePrefix_head2" />
		select b.case_no,
	       b.investigation_no,
	       b.case_kind,
	       b.occurr_date_from,
	       b.occurr_place,
	       p.name,
	       p.capture_flag,
	       t.id,
	       t.identify_unit,
	       t.identify_date,
	       t.identify_by,
	       t.identify_way,
	       (select count(1)
	          from w_b_case cba
	         where cba.case_id = b.id
	           and cba.delete_flag='0'
	           and rownum = 1) as bunchFlag,
	       p.capture_flag as captureFlag
	  from t_c_identify t
	  left join t_c_baseinfo b
	    on t.case_id = b.id
	    left join t_p_baseinfo p
	    on t.per_id=p.id
		<include refid="jsrdManagerList_where" />
		<include refid="order_By_String" />
    	<include refid="OraclePageSuffix" />
	</select>
	
	<select id="findJsrdManagerListForCount" parameterType="com.hisign.jsrd.model.JsrdFilter"
		resultType="java.lang.Integer">
		select
			count(1)
		from t_c_identify t
		  left join t_c_baseinfo b
		    on t.case_id = b.id
		<include refid="jsrdManagerList_where" />
	</select>
	
	<select id="getCaseIdByJsrdId" parameterType="java.lang.String"
		resultType="java.lang.String">
		select t.case_id from t_c_identify t
		where t.id=#{jsrdId,jdbcType=VARCHAR}
	</select>
	
	
	<select id="getJsrdInfoByJsrdId" parameterType="java.lang.String"
		resultMap="JsrdAllInfoResultMap">
		select 
			b.case_no,
			b.investigation_no,
			b.case_kind,
			b.occurr_date_from,
			b.occurr_place,
			p.NAME ,
			p.BIRTH_DATE,
			p.ID_CARD_NO,
			p.NATIVE_ADDRESS ,
			p.CAPTURE_FLAG ,
			p.CONTROL_FLAG ,
			t.id,
			t.identify_unit,
			t.identify_date,
			t.identify_by,
			t.PER_ID  ,
			t.CASE_ID  ,
			t.IDENTIFY_WAY ,
			t.IDENTIFY_SOURCE ,
			t.IDENTIFY_BY,
			t.IDENTIFY_UNIT,
			t.IDENTIFY_UNIT_CN ,
			t.IDENTIFY_DATE  ,
			t.IDENTIFY_NO  ,
			t.TRANS_NO ,
			t.PERSONNEL_NO  ,
			t.DELETE_FLAG  ,
			t.per_id,
		     (select count(1)
		        from w_b_case cba
		       where cba.case_id = b.id
		         and cba.delete_flag='0' 
		         and rownum = 1) as bunchFlag,
		    t.remark
		  from t_c_identify t
		  left join t_c_baseinfo b on b.id=t.case_id
		    left join t_p_baseinfo p on p.id =t.per_id
		    where t.id=#{jsrdId,jdbcType=VARCHAR}
	</select>
	
	<update id="updateJsrdInfoForEdit" parameterType="com.hisign.jsrd.model.IdentifyInfo" >
	    update t_c_identify
	    <set >
	      <if test="identifyDate != null" >
	        identify_Date = #{identifyDate,jdbcType=DATE,typeHandler=com.hisign.DateToStringTypeHandler},
	      </if>
	      <if test="identifySource != null" >
	        identify_Source = #{identifySource,jdbcType=VARCHAR},
	      </if>
	      <if test="identifyWay != null" >
	        identify_Way = #{identifyWay,jdbcType=CHAR},
	      </if>
	      <if test="identifyUnit != null" >
	        identify_Unit = #{identifyUnit,jdbcType=CHAR},
	      </if>
	      <if test="identifyNo != null" >
	        identify_no = #{identifyNo,jdbcType=CHAR},
	      </if>
	      <if test="identifyBy != null" >
	        identify_by = #{identifyBy,jdbcType=CHAR},
	      </if>
	      <if test="remark != null" >
	        remark = #{remark,jdbcType=CHAR},
	      </if>
	      <if test="modifyUserId != null" >
	        modify_User_Id = #{modifyUserId,jdbcType=CHAR},
	      </if>
	      <if test="modifyUserName != null" >
	        modify_User_name = #{modifyUserName,jdbcType=CHAR},
	      </if>
	      MODIFY_DATE=sysdate
	    </set>
	    where ID = #{id,jdbcType=VARCHAR}
  </update>
  
  <update id="deleteJsrdInfoById" parameterType="java.lang.String" >
  	update t_c_identify t
  		set 
 		t.delete_flag='1',
		MODIFY_DATE=sysdate
	where t.id=#{id,jdbcType=VARCHAR}
  </update>
  
  
   <insert id="insertPersonInfoByIdentifyInfo" parameterType="com.hisign.model.TPBaseInfoModel" >
	    insert into t_p_baseinfo (
			ID	,
			SOURCE	,
			PER_NO	,
			NAME	,
			BIRTH_DATE	,
			ID_CARD_NO	,
			NATIVE_ADDRESS,	
			DELETE_FLAG	,
			TRANSFER_TIME,	
			CREATE_UNIT	,
			CREATE_DATE	,
			CREATE_USER_ID	,
			CREATE_USER_NAME,	
			MODIFY_DATE	,
			MODIFY_USER_ID	,
			MODIFY_USER_NAME,	
			CAPTURE_FLAG	,
			CONTROL_FLAG	
		)values(
			#{person.id,jdbcType=VARCHAR},
			#{person.source,jdbcType=VARCHAR},
			#{person.perNo,jdbcType=VARCHAR},
			#{person.name,jdbcType=VARCHAR},
			#{person.birthDate,jdbcType=DATE,typeHandler=com.hisign.DateToStringTypeHandler},
			#{person.idCardNo,jdbcType=VARCHAR},
			#{person.nativeAddress,jdbcType=VARCHAR},
			'0',
			sysdate,
			#{createUnit,jdbcType=VARCHAR},
			sysdate,
			#{createUserId,jdbcType=VARCHAR},
			#{createUserName,jdbcType=VARCHAR},
			sysdate,
			#{createUserId,jdbcType=VARCHAR},
			#{createUserName,jdbcType=VARCHAR},
			#{person.captureFlag,jdbcType=VARCHAR},
			#{person.controlFlag,jdbcType=VARCHAR}
		)
  </insert>
  
  
  <insert id="insertCapturePersonInfo" parameterType="com.hisign.jsrd.model.IdentifyInfo" >
  		<selectKey resultType="java.lang.String" keyProperty="id" order="BEFORE" >
	      select sys_guid() from dual
	    </selectKey>
	    insert into t_p_capture (
			ID	,
			PER_ID	,
			PER_NO	,
			CAPTURE_DATE	,
			CAPTURE_UNIT	,
			DELETE_FLAG	,
			TRANSFER_TIME	,
			CREATE_UNIT,
			CREATE_DATE	,
			CREATE_USER_ID	,
			CREATE_USER_NAME	,
			MODIFY_DATE	,
			MODIFY_USER_ID	,
			MODIFY_USER_NAME
		)values(
			#{id,jdbcType=VARCHAR},
			#{perId,jdbcType=VARCHAR},
			#{person.perNo,jdbcType=VARCHAR},
			#{person.captureDate,jdbcType=DATE,typeHandler=com.hisign.DateToStringTypeHandler},
			#{person.captureUnit,jdbcType=VARCHAR},
			'0',
			sysdate,
			#{createUnit,jdbcType=VARCHAR},
			sysdate,
			#{createUserId,jdbcType=VARCHAR},
			#{createUserName,jdbcType=VARCHAR},
			sysdate,
			#{createUserId,jdbcType=VARCHAR},
			#{createUserName,jdbcType=VARCHAR}
		)
  </insert>
  
  
    <insert id="insertEntityComparison" parameterType="com.hisign.jsrd.model.IdentifyInfo" >
  		<selectKey resultType="java.lang.String" keyProperty="id" order="BEFORE" >
	      select sys_guid() from dual
	    </selectKey>
	    insert into m_entity_comparison (
			ID	,
			STAYB,	
			STABH,	
			GLBHA,	
			STBYB,	
			STBBH,	
			GLBHB,	
			LINK	,
			OCCURR_DATE,	
			OCCURR_PLACE,
			CASE_KIND	,
			PER_NAME	,
			PER_PAPER	,
			NATIVE_ADDRESS,	
			PER_BIRTHDAY,	
			DELETE_FLAG	,
			TRANSFER_TIME,	
			CREATE_UNIT	,
			CREATE_DATE,
			CREATE_USER_ID,	
			CREATE_USER_NAME,	
			MODIFY_DATE	,
			MODIFY_USER_ID,
			MODIFY_USER_NAME	
		)values(
			#{id,jdbcType=VARCHAR},
			'case_m_detail',
	        #{caseInfo.caseNo,jdbcType=CHAR},
			#{caseInfo.id,jdbcType=VARCHAR},
			'badperson_m_detail',
			#{person.perNo,jdbcType=VARCHAR},
			#{person.id,jdbcType=VARCHAR},
			'102',
			#{caseInfo.occurrDateFrom,jdbcType=DATE,typeHandler=com.hisign.DateToStringTypeHandler},
			#{caseInfo.occurrPlace,jdbcType=VARCHAR},
			#{caseInfo.caseKind,jdbcType=VARCHAR},
			#{person.name,jdbcType=VARCHAR},
			#{person.idCardNo,jdbcType=VARCHAR},
			#{person.nativeAddress,jdbcType=VARCHAR},
			#{person.birthDate,jdbcType=DATE,typeHandler=com.hisign.DateToStringTypeHandler},
			'0',
			sysdate,
			#{createUnit,jdbcType=VARCHAR},
			sysdate,
			#{createUserId,jdbcType=VARCHAR},
			#{createUserName,jdbcType=VARCHAR},
			sysdate,
			#{createUserId,jdbcType=VARCHAR},
			#{createUserName,jdbcType=VARCHAR}
		)
  </insert>
  
  <update id="deleteEntityComparisonById" parameterType="java.lang.String" >
	update m_entity_comparison c
	 set c.delete_flag = '1'
	where c.glbha = (select t.case_id
	                   from t_c_identify t
	                  where t.id = #{id,jdbcType=VARCHAR}
	                    and rownum = 1)
	  and c.glbhb = (select t.per_id
	                   from t_c_identify t
	                  where t.id = #{id,jdbcType=VARCHAR}
	                    and rownum = 1)
  </update>
  
  <select id="getPersonInfoBySfzh" parameterType="java.lang.String"
		resultType="com.hisign.model.TPBaseInfoModel">
		select p.id as id,
		       p.PER_NO as perNo,
		       p.NAME as name,
		       to_char(p.BIRTH_DATE, 'yyyy-MM-dd') as birthDate,
		       p.id_card_no as idCardNo,
		       p.NATIVE_ADDRESS as nativeAddress,
		       p.capture_flag as captureFlag,
		       p.control_flag as controlFlag,
		       (select c.capture_date
		          from t_p_capture c
		         where c.per_id = p.id
		           and c.delete_flag = '0'
		           and rownum = 1) as captureDate,
		       (select c.capture_unit
		          from t_p_capture c
		         where c.per_id = p.id
		           and c.delete_flag = '0'
		           and rownum = 1) as captureUnit
		  from t_p_baseinfo p
		 where p.id_card_no = #{sfzh, jdbcType = VARCHAR}
		 and rownum=1
	</select>
	
	<select id="findNewPerNoIfExists" parameterType="java.lang.String"
		resultType="java.lang.Integer">
		select count(1)
		  from t_p_baseinfo p
		 where p.per_no = #{perNo, jdbcType = VARCHAR}
		 and rownum=1
	</select>
	
	
  <update id="updatePersonCaptureInfo" parameterType="com.hisign.model.TPBaseInfoModel" >
  	update t_p_baseinfo
  	<set>
      <if test="controlFlag != null" >
        control_Flag = #{controlFlag,jdbcType = VARCHAR}，
      </if>
      <if test="captureFlag != null" >
        capture_flag = #{captureFlag,jdbcType = VARCHAR}，
      </if>
      MODIFY_DATE=sysdate
	</set>
	where ID = #{id,jdbcType=VARCHAR}
  </update>
  
  
  <select id="getCaptureInfoById" parameterType="java.lang.String"
		resultType="com.hisign.model.TPCapture">
		select 
			to_char(CAPTURE_DATE,'yyyy-MM-dd') as captureDate,
			CAPTURE_UNIT as captureUnit
		 from t_p_capture p
		 where p.per_id = #{perId, jdbcType = VARCHAR}
		 and rownum=1
	</select>
	
	
	<update id="updateCapturePersonInfo" parameterType="com.hisign.jsrd.model.IdentifyInfo" >
  	update t_p_capture
  	<set>
      <if test="person.captureUnit != null" >
        capture_unit = #{person.captureUnit,jdbcType = VARCHAR},
      </if>
      <if test="person.captureDate != null" >
        capture_Date = #{person.captureDate,jdbcType=DATE,typeHandler=com.hisign.DateToStringTypeHandler},
      </if>
      MODIFY_DATE=sysdate
	</set>
	where per_id = #{perId,jdbcType=VARCHAR}
  </update>
</mapper>
